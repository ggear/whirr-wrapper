#!/bin/sh

if [ $# -le 0 ]; then
  echo "User not specified"
  exit 1
fi

export CDHUSER="$1"
shift

su $CDHUSER -c \
'source "$WHIRR_WRAPPER_HOME"/bin/whirr.env; '\
'assertClusterInitialised; '\
'export HADOOP_ROOT_LOGGER="ERROR,console"; '\
'export HADOOP_SECURITY_LOGGER="OFF,console"; '\
'export HDFS_AUDIT_LOGGER="OFF,console"; '\
'[ "$CLUSTER_SECURITY" = "KERBEROS" ] && $WHIRR_WRAPPER_HOME/bin/whirr-kinit $CDHUSER; '\
'hadoop --config $WHIRR_WRAPPER_HOME/cfg/$CLUSTER_NAME $0 "$@"' -- "$@"
